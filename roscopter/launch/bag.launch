<?xml version="1.0"?>

<launch>

  <arg name="bag_filename"        value="slim3"/>
  <arg name="bag_file_path"       value="../data/ragnarok_tests/estimator_data_0118/"/>
  <arg name="ublox_gnss"          value="/rover/PosVelEcef"/>
  <arg name="ublox_relpos"        value="/boat/RelPos"/>
  <arg name="base_odom"           value="/boat/odom"/>
  <arg name="boat_ublox_gnss"     value="/boat/PosVelEcef"/>
  <arg name="boat_ublox_relpos"   value="/boat/compass/RelPos"/>
  <arg name="imu_topic"           value="/boat/imu"/>
  <arg name="common_ref_lla"      value="/ref_lla"/>

  <node pkg="rosbag" type="play" name="player" output="screen" args="--clock $(arg bag_file_path)$(arg bag_filename).bag"/>

  <include file="$(find roscopter)/launch/include/roscop.launch">
    <arg name="ublox_gnss"          value="$(arg ublox_gnss)"/>
    <arg name="ublox_relpos"        value="$(arg ublox_relpos)"/>
    <arg name="base_odom"           value="$(arg base_odom)"/>
  </include> 

  <group ns="boat">
    <include file="$(find roscopter)/launch/include/boat_estimator.launch">
      <arg name="imu_topic"   value="$(arg imu_topic)"/>
      <arg name="ublox_gnss" value="$(arg boat_ublox_gnss)"/>
      <arg name="ublox_relpos" value="$(arg boat_ublox_relpos)"/>
      <arg name="common_ref_lla" value="$(arg common_ref_lla)"/>
    </include>
  </group>

  <node pkg="rosbag" type="record" name="record" output="screen" args="-O ../data/$(arg bag_filename).bag --all"/>
</launch>
